(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mine/login"],{"06e4":function(e,t,a){"use strict";(function(e){a("16f4"),a("921b");n(a("66fd"));var t=n(a("ca18"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,a("543d")["createPage"])},"7a7f":function(e,t,a){},a7d4:function(e,t,a){"use strict";var n=a("7a7f"),o=a.n(n);o.a},ca18:function(e,t,a){"use strict";a.r(t);var n=a("f20e"),o=a("d99f");for(var i in o)"default"!==i&&function(e){a.d(t,e,(function(){return o[e]}))}(i);a("a7d4");var s,r=a("f0c5"),u=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);t["default"]=u.exports},d99f:function(e,t,a){"use strict";a.r(t);var n=a("ea93"),o=a.n(n);for(var i in n)"default"!==i&&function(e){a.d(t,e,(function(){return n[e]}))}(i);t["default"]=o.a},ea93:function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a={data:function(){return{name:"",position:"",phone:0,companyName:[],companyNumber:[],companyIndex:0,areaName:[],areaNumber:[],areaIndex:0,wxLogin:!1,avatarUrl:this.ImgUrl+"/static/mine/touxiang.png",openId:"",u_id:"",ImgUrl:this.ImgUrl,tourist:""}},methods:{companyChange:function(e){this.companyIndex=e.target.value},areaChange:function(e){this.areaIndex=e.target.value},getCompany:function(){var t=this.WebUrl,a=this;e.request({url:t+"/getFirm",success:function(e){console.log(e),e.data.data.forEach((function(e,t){a.companyNumber.push(e.firm_id),a.companyName.push(e.name)}))}})},getArea:function(){var t=this.WebUrl,a=this;e.request({url:t+"/getArea",success:function(e){console.log(e),e.data.data.forEach((function(e,t){a.areaName.push(e.dict_name),a.areaNumber.push(e.dict_id)}))}})},nameValue:function(e){this.name=e.target.value},positionValue:function(e){this.position=e.target.value},phoneValue:function(e){this.phone=e.target.value},setUser:function(){var t=this.WebUrl,a=this;""===this.name?e.showModal({title:"提示",content:"请输入名字",showCancel:!1}):""===this.position?e.showModal({title:"提示",content:"请输入职位",showCancel:!1}):/^1[3456789]\d{9}$/.test(this.phone)?e.request({url:t+"/getPersonnel",method:"POST",data:{u_id:a.u_id,firm_id:a.companyNumber[a.companyIndex],position:a.position,phone:a.phone,u_name:a.name,head:a.avatarUrl},success:function(t){e.showModal({title:"提示",content:t.data.msg,showCancel:!1,success:function(t){t.confirm&&e.navigateBack({delta:1})}}),console.log(t.data.msg),t.data.msg,console.log(111),e.setStorage({key:"companyName",data:a.companyNumber[a.companyIndex]})}}):e.showModal({title:"提示",content:"手机号码有误，请重新输入",showCancel:!1})},getUserInfo:function(t){var a=this,n=this.WebUrl;e.getUserInfo({provider:"weixin",success:function(t){var o={nickName:t.userInfo.nickName,avatarUrl:t.userInfo.avatarUrl,gender:t.userInfo.gender,city:t.userInfo.city};e.getStorage({key:"openid",success:function(t){e.request({url:n+"/addUser",method:"POST",data:{area_id:3,city:o.city,gender:o.gender,nickName:o.nickName,avatarUrl:o.avatarUrl,openid:t.data},success:function(e){a.u_id=e.data.data.u_id,a.judgeUser()}})}})}})},Login:function(){var t=this.WebUrl,a=this;e.login({provider:"weixin",success:function(n){var o=n.code;e.request({url:t+"/wxLogin",data:{code:o},method:"GET",header:{"content-type":"application/json"},success:function(t){e.setStorage({key:"openId",data:t.data.data.openid,success:function(){a.judgeUser()}})}})}})},judgeUser:function(){var t=this.WebUrl,a=this;e.getStorage({key:"openid",success:function(n){e.request({url:t+"/judgeUser",method:"POST",data:{openid:n.data},success:function(t){console.log(t),"用户已存在！"===t.data.msg?(a.nickname=t.data.data.u_name||"",a.avatarUrl=t.data.data.head||"",a.u_id=t.data.data.u_id,a.tourist=!0,e.setStorage({key:"tourist",data:!0})):a.wxLogin=!0},fail:function(e){a.Login()}})}})},changePopup:function(){!0===this.wxLogin?this.wxLogin=!1:this.wxLogin=!0}},onLoad:function(){this.getCompany(),this.getArea(),this.judgeUser()}};t.default=a}).call(this,a("543d")["default"])},f20e:function(e,t,a){"use strict";var n,o=function(){var e=this,t=e.$createElement;e._self._c},i=[];a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return n}))}},[["06e4","common/runtime","common/vendor"]]]);